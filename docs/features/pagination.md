# Условная пагинация книг

## Описание

Реализована условная пагинация для списка книг:
- **Если книг <= 30**: возвращается полный список без пагинации
- **Если книг > 30**: применяется пагинация с размером страницы 30 книг

## Преимущества

1. **Быстрая загрузка для малых категорий**: категории с небольшим количеством книг загружаются мгновенно
2. **Оптимизация для больших категорий**: большие категории используют пагинацию для лучшей производительности
3. **Автоматическое определение**: бэкенд сам решает, применять пагинацию или нет

## Реализация

### Бэкенд

**Файл:** `backend/books/pagination.py`

```python
class ConditionalBookPagination(PageNumberPagination):
    """
    Условная пагинация для книг:
    - Если книг <= 30: возвращаем все книги без пагинации
    - Если книг > 30: применяем пагинацию с размером страницы 30
    """
    page_size = 30
```

**Использование:** Применяется автоматически в `BookViewSet` для действия `list`.

### Формат ответа API

#### Когда пагинация НЕ применена (книг <= 30):
```json
{
  "count": 25,
  "results": [...],
  "paginated": false
}
```

#### Когда пагинация применена (книг > 30):
```json
{
  "count": 684,
  "next": "http://api.example.com/api/books/?page=2",
  "previous": null,
  "results": [...],
  "paginated": true
}
```

### Фронтенд

**Файл:** `frontend/src/pages/MainPage.js`

Фронтенд отображает пагинацию с кнопками навигации:
- Если `paginated: false` - пагинация не отображается, показываются все книги
- Если `paginated: true` - отображается UI пагинации с кнопками "Предыдущая" и "Следующая"
- Пользователь может переключаться между страницами, загружая только нужную страницу
- Страница автоматически сбрасывается на 1 при изменении фильтров

## Примеры использования

### Категория с 15 книгами
```
GET /api/books/?category=1
```
**Ответ:** Все 15 книг в одном запросе, `paginated: false`

### Категория с 100 книгами
```
GET /api/books/?category=2
```
**Ответ:** Первые 30 книг, `paginated: true`, нужно загрузить еще 3 страницы

### "Все категории" (684 книги)
```
GET /api/books/
```
**Ответ:** Пагинация применена, показывается первая страница (30 книг). Пользователь может переключаться между страницами с помощью кнопок навигации.

## Производительность

- **Малые категории (≤30 книг)**: загрузка ~0.1-0.2 сек, все книги отображаются сразу
- **Большие категории (>30 книг)**: первоначальная загрузка ~0.1-0.2 сек, показывается только текущая страница (30 книг)
- **Переключение страниц**: ~0.1-0.2 сек на каждую страницу

## UI пагинации

На фронтенде отображается:
- Информация о текущей странице: "Страница X из Y (Z книг всего)"
- Кнопка "← Предыдущая" (отключена на первой странице)
- Кнопка "Следующая →" (отключена на последней странице)

Пагинация появляется автоматически только когда книг больше 30.

## Настройка

Размер страницы можно изменить в `ConditionalBookPagination.page_size` (по умолчанию 30).

```python
class ConditionalBookPagination(PageNumberPagination):
    page_size = 50  # Изменить размер страницы
```

