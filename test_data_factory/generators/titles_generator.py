"""
Генератор названий книг
"""
import random


# Шаблоны названий книг
TITLE_TEMPLATES = [
    # Исторические
    "История {topic}",
    "Великие {topic}",
    "Эпоха {topic}",
    "Хроники {topic}",
    "{topic}: прошлое и настоящее",
    "Тайны {topic}",
    # Научные
    "Основы {topic}",
    "Теория {topic}",
    "Практическое руководство по {topic}",
    "Энциклопедия {topic}",
    "Справочник по {topic}",
    # Художественные
    "Повести о {topic}",
    "Рассказы из жизни {topic}",
    "Легенды {topic}",
    "Сказания о {topic}",
    # Философские
    "Размышления о {topic}",
    "Философия {topic}",
    "Мир {topic}",
    # Прочие
    "{topic}: полное собрание",
    "Искусство {topic}",
    "Наука о {topic}",
    "{topic} для всех",
]

# Топики для генерации
TOPICS = [
    "древней Руси", "Российской империи", "Советского Союза", "современной России",
    "европейской истории", "мировой литературы", "русской литературы",
    "философии", "искусства", "музыки", "живописи", "архитектуры",
    "науки и техники", "природы", "географии", "путешествий",
    "войны и мира", "любви и дружбы", "человека", "общества",
    "культуры", "традиций", "обычаев", "религии",
    "приключений", "тайн", "загадок", "открытий",
    "победы", "героизма", "мужества", "мудрости",
    "поэзии", "прозы", "драматургии", "критики",
    "языка", "литературы", "образования", "просвещения",
]

# Подзаголовки (субтитлы)
SUBTITLE_TEMPLATES = [
    "Сборник избранных произведений",
    "В переводе с русского языка",
    "Иллюстрированное издание",
    "С примечаниями и комментариями",
    "Полное собрание сочинений",
    "Издание подготовлено к печати",
    "С вступительной статьей",
    "В двух томах",
    "С цветными иллюстрациями",
    "Редакция и подготовка текста",
    "Библиографическое издание",
    "Юбилейное издание",
    "Подарочное издание",
    "Коллекционное издание",
]

# Описания книг
DESCRIPTION_TEMPLATES = [
    "Это произведение представляет собой глубокое исследование темы {topic}. "
    "Автор подробно рассматривает различные аспекты, предлагая читателю "
    "уникальный взгляд на предмет изучения.",
    
    "Книга посвящена {topic} и охватывает широкий спектр вопросов. "
    "Автор использует доступный язык, делая сложные концепции понятными "
    "для широкой аудитории.",
    
    "В этом издании собраны материалы о {topic}, представляющие интерес "
    "как для специалистов, так и для обычных читателей. "
    "Книга содержит множество иллюстраций и примеров.",
    
    "Автор представляет читателю увлекательное повествование о {topic}, "
    "используя богатый фактический материал и интересные примеры. "
    "Издание будет полезно всем, кто интересуется данной темой.",
    
    "Эта книга - результат многолетнего исследования {topic}. "
    "Автор систематизирует накопленные знания и представляет их "
    "в доступной и интересной форме.",
]


def generate_book_title(category_name: str = None) -> dict:
    """
    Генерирует название книги, подзаголовок и описание
    
    Args:
        category_name: Название категории (для уточнения темы)
    
    Returns:
        {
            'title': str,
            'subtitle': str (опционально),
            'description': str
        }
    """
    # Выбираем случайный топик
    topic = random.choice(TOPICS)
    
    # Если есть категория, можно использовать её для уточнения
    if category_name:
        # Пытаемся извлечь ключевые слова из категории
        category_keywords = extract_keywords_from_category(category_name)
        if category_keywords:
            topic = random.choice([topic] + category_keywords)
    
    # Выбираем шаблон названия
    template = random.choice(TITLE_TEMPLATES)
    title = template.format(topic=topic)
    
    # Добавляем уникальность (опционально)
    if random.random() < 0.3:  # 30% chance
        additions = ["", " том 1", " том 2", " том I", " том II", " часть 1", " часть 2"]
        addition = random.choice(additions)
        if addition:
            title += addition
    
    # Генерируем подзаголовок (70% chance)
    subtitle = None
    if random.random() < 0.7:
        subtitle = random.choice(SUBTITLE_TEMPLATES)
        if random.random() < 0.3:
            subtitle += f". {random.choice(['Том 1', 'Том 2', 'Часть 1', 'Часть 2'])}"
    
    # Генерируем описание
    desc_template = random.choice(DESCRIPTION_TEMPLATES)
    description = desc_template.format(topic=topic)
    
    # Иногда добавляем дополнительную информацию
    if random.random() < 0.4:
        extras = [
            " Издание дополнено справочными материалами.",
            " В книге представлены редкие документы и фотографии.",
            " К изданию приложены карты и схемы.",
            " Текст сопровождается подробными комментариями.",
        ]
        description += random.choice(extras)
    
    return {
        'title': title,
        'subtitle': subtitle,
        'description': description,
    }


def extract_keywords_from_category(category_name: str) -> list[str]:
    """
    Извлекает ключевые слова из названия категории для использования в названиях
    
    Args:
        category_name: Название категории
    
    Returns:
        Список потенциальных топиков
    """
    if not category_name:
        return []
    
    # Простая логика: берем слова после двоеточия или ключевые слова
    keywords = []
    
    # Убираем префиксы типа "История:", "Литература:" и т.д.
    name = category_name.lower()
    
    # Ищем ключевые слова
    key_phrases = [
        "война", "литература", "искусство", "наука", "философия",
        "религия", "политика", "экономика", "право", "техника",
        "медицина", "образование", "путешествия", "география",
    ]
    
    for phrase in key_phrases:
        if phrase in name:
            keywords.append(f"русской {phrase}" if phrase != "литература" else "русской литературы")
            keywords.append(f"истории {phrase}")
    
    return keywords[:3]  # Возвращаем максимум 3


if __name__ == '__main__':
    # Тест
    print("Примеры сгенерированных названий:\n")
    for i in range(5):
        result = generate_book_title("История России")
        print(f"{i+1}. {result['title']}")
        if result['subtitle']:
            print(f"   Подзаголовок: {result['subtitle']}")
        print(f"   Описание: {result['description'][:80]}...")
        print()

